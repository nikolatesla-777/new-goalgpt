# GoalGPT Backend - Environment Variables Template
# Copy this file to .env and fill in your actual values

# Database (Supabase PostgreSQL)
DB_HOST=aws-0-[REGION].pooler.supabase.com
DB_PORT=6543
DB_NAME=postgres
DB_USER=postgres.[PROJECT_REF]
DB_PASSWORD=your_supabase_password_here
DB_MAX_CONNECTIONS=20

# Database Connection Pool Monitoring (PR-P0-3)
DB_MONITOR_ENABLED=true
DB_SLOW_QUERY_LOG_ENABLED=true
DB_SLOW_QUERY_THRESHOLD_MS=2000
DB_POOL_UTIL_WARN_PCT=80
DB_POOL_UTIL_CRIT_PCT=90
DB_POOL_LOG_INTERVAL_MS=60000

# Full Database URL (for scripts - constructed from above values)
DATABASE_URL=postgres://postgres.[PROJECT_REF]:your_password@aws-0-[REGION].pooler.supabase.com:6543/postgres

# API Security
PREDICTION_API_KEY=your_secure_api_key_here

# Frontend URL for CORS
FRONTEND_URL=https://your-frontend-domain.com

# TheSports API
THESPORTS_API_BASE_URL=https://api.thesports.com/v1/football
THESPORTS_API_SECRET=your_thesports_secret_here
THESPORTS_API_USER=goalgpt

# FootyStats API (Advanced Betting Statistics)
FOOTYSTATS_API_KEY=your_footystats_api_key_here

# Telegram Bot Configuration (Week-2B: Single bot, 7 channels)
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz

# Feature flags
TELEGRAM_PUBLISH_ENABLED=false  # Set to 'true' to enable Telegram publishing (default: false)
TELEGRAM_STRICT_CONFIG=true     # Fail-fast on missing channel IDs if PUBLISH_ENABLED=true (default: true)
TELEGRAM_DRY_RUN=false          # Set to 'true' to log messages without sending to Telegram (default: false)

# Market-specific channels (each market gets its own channel)
# REQUIRED if TELEGRAM_PUBLISH_ENABLED=true
TELEGRAM_CHANNEL_O25=-1001234567890        # 2.5 Üst Gol
TELEGRAM_CHANNEL_BTTS=-1001234567891       # Karşılıklı Gol (BTTS)
TELEGRAM_CHANNEL_HT_O05=-1001234567892     # İlk Yarı 0.5 Üst
TELEGRAM_CHANNEL_O35=-1001234567893        # 3.5 Üst Gol
TELEGRAM_CHANNEL_HOME_O15=-1001234567894   # Ev Sahibi 1.5 Üst
TELEGRAM_CHANNEL_CORNERS_O85=-1001234567895 # Korner 8.5 Üst
TELEGRAM_CHANNEL_CARDS_O25=-1001234567896  # Kart 2.5 Üst

# Legacy channel ID (deprecated - use market-specific channels above)
TELEGRAM_CHANNEL_ID=-1001234567890
# PHASE-0: Idempotency control (default: false = duplicates blocked)
TELEGRAM_ALLOW_DUPLICATES=false

# Server
PORT=3000
NODE_ENV=production
LOG_LEVEL=info

# ====================
# MOBILE APP FEATURES
# ====================

# Firebase Admin SDK (for OAuth verification & FCM)
FIREBASE_PROJECT_ID=goalgpt-mobile
FIREBASE_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nYOUR_PRIVATE_KEY_HERE\n-----END PRIVATE KEY-----
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xxxxx@goalgpt-mobile.iam.gserviceaccount.com
FIREBASE_SERVER_KEY=AAAA...your-fcm-server-key-here

# Google OAuth (for backend token verification)
GOOGLE_CLIENT_ID=XXXXXXXX-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-XXXXXXXXXXXXXXXXXXXX

# Apple Sign In (for backend token verification)
APPLE_BUNDLE_ID=com.goalgpt.mobile
APPLE_TEAM_ID=XXXXXXXXXX
APPLE_KEY_ID=XXXXXXXXXX
APPLE_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nYOUR_APPLE_PRIVATE_KEY\n-----END PRIVATE KEY-----

# JWT (for access/refresh tokens)
# Generate secrets with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=your-super-secret-jwt-key-min-64-chars-recommended
JWT_REFRESH_SECRET=your-super-secret-refresh-key-min-64-chars-recommended
JWT_ACCESS_TOKEN_EXPIRES_IN=1h
JWT_REFRESH_TOKEN_EXPIRES_IN=30d

# RevenueCat (for subscription webhook verification)
REVENUECAT_WEBHOOK_SECRET=rcwsk_XXXXXXXXXXXXXXXXXXXXXXXX
REVENUECAT_API_KEY=sk_XXXXXXXXXXXXXXXXXXXXXXXX

# AdMob (for ad metrics - optional)
ADMOB_PUBLISHER_ID=pub-XXXXXXXXXXXXXXXX

# Sentry (Error Tracking)
SENTRY_DSN=https://XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX@sentry.io/XXXXXXX
SENTRY_ENVIRONMENT=production

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ============================================================
# P1: JOB STAGGER CONFIGURATION (6-Field Cron)
# ============================================================
# Staggers job execution using native cron second precision.
# Valid range: 0-59. Set to 0 to disable for specific job.
# Converts 5-field cron ("* * * * *") to 6-field ("15 * * * * *")

# Feature flag (default: DISABLED for safe rollout)
JOB_STAGGER_ENABLED=false

# Every-minute jobs (0s, 15s, 30s, 45s)
JOB_STAGGER_REFERRAL_T2=0
JOB_STAGGER_REFERRAL_T3=15
JOB_STAGGER_NOTIFICATIONS=30
JOB_STAGGER_STATS_SYNC=45

# Every-5-minute jobs (5s, 25s)
JOB_STAGGER_BADGES=5
JOB_STAGGER_PREDICTIONS=25

# Every-10-minute jobs (10s, 40s)
JOB_STAGGER_STUCK_MATCHES=10
JOB_STAGGER_TELEGRAM=40

# ============================================================
# TWITTER / X PUBLISHING
# ============================================================
TWITTER_PUBLISH_ENABLED=false       # Set to 'true' to enable auto-publish
TWITTER_DRY_RUN=true                # Set to 'true' to log without sending tweets
TWITTER_KILL_SWITCH=false           # Set to 'true' to stop all Twitter publishing immediately
TWITTER_API_KEY=                    # Consumer Key (OAuth 1.0a)
TWITTER_API_SECRET=                 # Consumer Secret (OAuth 1.0a)
TWITTER_ACCESS_TOKEN=               # Access Token (OAuth 1.0a, Read+Write)
TWITTER_ACCESS_SECRET=              # Access Token Secret (OAuth 1.0a)
TWITTER_AUTO_PUBLISH_HOUR=6         # UTC hour for daily auto-publish (06:00 UTC = 09:00 Turkey)
TWITTER_MIN_CONFIDENCE=65           # Minimum confidence % to include a trend in the thread
TWITTER_STRICT_CONFIG=true          # Fail-fast if credentials missing when not in DRY_RUN
